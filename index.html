<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web DJ</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #111; color: #fff; }
    #player-container, #voice-container { opacity: 0; transition: opacity 2s ease; }
    audio { display: none; }
    button { padding: 1rem; font-size: 1.2rem; margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>ðŸŽ§ DJ Webpage</h1>
  <button onclick="startDJ()">Start DJ</button>

  <!-- YouTube Player -->
  <div id="player-container">
    <div id="player"></div>
  </div>

  <!-- Audio Element for Voice Clips -->
  <div id="voice-container">
    <audio id="voice" preload="auto"></audio>
  </div>

  <script>
    const voiceClips = [
      'https://yourserver.com/clip1.mp3',
      'https://yourserver.com/clip2.mp3',
      'https://yourserver.com/clip3.mp3'
    ];

    const youtubeVideos = [
      'VIDEO_ID_1',
      'VIDEO_ID_2',
      'VIDEO_ID_3'
    ];

    let player;
    let voiceAudio = document.getElementById('voice');

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '0', width: '0',
        videoId: getRandomYouTubeID(),
        events: {
          'onReady': () => {}, // Not autoplaying initially
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.ENDED) {
        fadeOut('player-container', () => {
          playRandomClip();
        });
      }
    }

    function getRandomYouTubeID() {
      return youtubeVideos[Math.floor(Math.random() * youtubeVideos.length)];
    }

    function playRandomClip() {
      const clip = voiceClips[Math.floor(Math.random() * voiceClips.length)];
      voiceAudio.src = clip;
      voiceAudio.volume = 0;
      voiceAudio.play();

      fadeIn('voice-container');
      fadeVolume(voiceAudio, 0, 1, 2000); // fade in

      voiceAudio.onended = () => {
        fadeOut('voice-container', () => {
          fadeVolume(voiceAudio, 1, 0, 2000);
          player.loadVideoById(getRandomYouTubeID());
          fadeIn('player-container');
        });
      };
    }

    function fadeIn(id) {
      const el = document.getElementById(id);
      el.style.opacity = 1;
    }

    function fadeOut(id, callback) {
      const el = document.getElementById(id);
      el.style.opacity = 0;
      setTimeout(callback, 2000); // match CSS transition duration
    }

    function fadeVolume(audio, from, to, duration) {
      const steps = 20;
      const stepTime = duration / steps;
      let currentStep = 0;
      const interval = setInterval(() => {
        currentStep++;
        audio.volume = from + (to - from) * (currentStep / steps);
        if (currentStep >= steps) clearInterval(interval);
      }, stepTime);
    }

    function startDJ() {
      playRandomClip(); // Start with a voice clip
    }

    // Load YouTube IFrame API
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);
  </script>
</body>
</html>